# Floorball LLM Analysis - Application Configuration
# Copy this file to config.yaml and customize for your needs
# 
# This file contains APPLICATION SETTINGS (non-sensitive)
# API keys and secrets go in .env file (never commit to git)

# ============================================================
# Backend Configuration
# ============================================================

# Which LLM backend to use
# Options: simulated, openai, gemini, anthropic, huggingface, ollama
llm_backend: openai

# Sport type for analysis
# Options: floorball, hockey, soccer
sport: floorball

# ============================================================
# Model Selection (per backend)
# ============================================================

# OpenAI model selection
# Options: gpt-4o, gpt-4o-mini, gpt-4-turbo
openai_model: gpt-5o-mini

# Anthropic model selection
# Options: claude-3-5-sonnet-20241022, claude-3-opus-20240229
# anthropic_model: claude-3-5-sonnet-20241022

# HuggingFace model selection
# huggingface_model: meta-llama/Llama-3.2-3B-Instruct

# Gemini model selection
# Options: gemini-1.5-pro, gemini-1.5-flash, gemini-1.5-flash-8b
# Note: Don't use -latest suffix, just the base model name
# gemini_model: gemini-2.5-flash

# Ollama configuration
# ollama_endpoint: http://localhost:11434
# ollama_model: llama3.2

# ============================================================
# Processing Settings
# ============================================================

# Output directory for generated clips
clip_output_dir: clips

# Enable LLM response caching (faster, saves API costs)
cache_enabled: true
cache_dir: .cache

# Parallel processing for batch operations
parallel_processing: false
max_workers: 4

# ============================================================
# Rate Limit Settings (for chunk parallel processing)
# ============================================================
# These settings control how many parallel workers process video chunks
# and how to handle API rate limit errors (HTTP 429)

# OpenAI Rate Limits:
# - gpt-4o: 30,000 TPM / 500 RPM (Tokens/Requests Per Minute)
# - gpt-4o-mini: 500,000 TPM / 500 RPM
# Recommendation: Use 1-2 workers for gpt-4o, 3-4 for gpt-4o-mini
max_workers_openai: 2

# Gemini Rate Limits:
# - Free tier: 15 RPM (requests per minute)
# - Pay-as-you-go: Higher limits, varies by model
# Recommendation: Use 4-6 workers for paid tier, 2 for free tier
max_workers_gemini: 4

# How long to wait when hitting rate limits (seconds)
# OpenAI typically suggests waiting 30-60s after 429 error
rate_limit_retry_delay: 40.0

# Maximum retry attempts for rate-limited requests
# After this many retries, the chunk will be skipped
rate_limit_max_retries: 3

# ============================================================
# Retry & Timeout Settings (general API errors)
# ============================================================

max_retries: 3
retry_delay: 1.0
timeout: 60.0

# ============================================================
# Logging
# ============================================================

log_level: INFO  # Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
log_file: logs/floorball_llm.log  # Log file path (relative to project root)

# ============================================================
# Sport Presets - Customize event detection per sport
# ============================================================

sport_presets:
  floorball:
    name: floorball
    event_types:
      - goal
      - assist
      - shot
      - save
      - penalty
      - timeout
      - unforced error
    clip_padding_before: 10
    clip_padding_after: 5
    time_dedup_window: 5.0
    frame_interval: 5.0  # Extract 1 frame every 8 seconds (fast-paced sport)
    max_frames: 25  # Max frames to send to LLM per API call
    keywords:
      goal: [goal, score, scores]
      assist: [assist, pass, setup]
      shot: [shot, shoots, attempt]
      save: [save, saves, stopped, block]
      penalty: [penalty, foul, 2 minutes, bench]
      timeout: [timeout, time out, break]
  
  hockey:
    name: hockey
    event_types:
      - goal
      - assist
      - shot
      - save
      - penalty
      - icing
      - offside
    clip_padding_before: 6
    clip_padding_after: 10
    time_dedup_window: 5.0
    frame_interval: 10.0  # Standard sampling
    max_frames: 20
    keywords:
      goal: [goal, score]
      penalty: [penalty, 2 minutes, 5 minutes]
      icing: [icing]
      offside: [offside]
  
  soccer:
    name: soccer
    event_types:
      - goal
      - assist
      - shot
      - save
      - corner
      - freekick
      - penalty
      - yellow_card
      - red_card
    clip_padding_before: 8
    clip_padding_after: 12
    time_dedup_window: 5.0
    frame_interval: 15.0  # Sample less frequently for slower-paced sport
    max_frames: 15  # Fewer frames needed
    keywords:
      goal: [goal, score]
      corner: [corner, corner kick]
      yellow_card: [yellow card, booking]
      red_card: [red card, sent off]
